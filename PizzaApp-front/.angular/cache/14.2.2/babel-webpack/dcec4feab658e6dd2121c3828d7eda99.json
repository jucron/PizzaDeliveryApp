{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/jrenau01/IdeaProjects/PizzaDeliveryApp/PizzaApp-front/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { ActivatedRouteSnapshot, Router, RouterStateSnapshot, UrlTree } from '@angular/router';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../client.service\";\nimport * as i2 from \"@angular/router\";\nexport class AlreadyAuthIn {\n  constructor(clientService, router) {\n    this.clientService = clientService;\n    this.router = router;\n  }\n\n  canActivate(route, state) {\n    var _this = this;\n\n    if (localStorage.getItem('mainUsername') == null) {\n      console.log('AlreadyAuthGuard: not logged in Angular, remaining in page');\n      return true;\n    }\n\n    let logged;\n\n    const test = /*#__PURE__*/function () {\n      var _ref = _asyncToGenerator(function* () {\n        yield _this.clientService.isUserLogged().then(r => logged = r);\n      });\n\n      return function test() {\n        return _ref.apply(this, arguments);\n      };\n    }(); // return this.clientService.isUserLogged()\n    //   .subscribe(\n    //     (response: Response) => {\n    //       let loginStatus = response.message;\n    //       console.log(\"isUserLogged: LoginStatus from backend: \" + loginStatus)\n    //       if (loginStatus == 'not_logged') {\n    //         localStorage.clear();\n    //         console.log('AlreadyAuthGuard: user not logged, remaining in page');\n    //         return true;\n    //       } else {\n    //         console.log('AlreadyAuthGuard: user already logged, redirecting to client-action page');\n    //         return this.router.navigate(['/client/client-action'], {skipLocationChange: true});\n    //       }\n    //     });\n    // setTimeout(() => {\n    //     console.log('AlreadyAuthGuard: checkLoginStatus is '+typeof logged+', waiting 1,5 seconds')\n    // }, 2000);\n    //\n\n\n    console.log('AlreadyAuthGuard: logged is ' + logged);\n\n    if (logged == true) {\n      console.log('AlreadyAuthGuard: user already logged, redirecting to client-action page');\n      return this.router.navigate(['/client/client-action'], {\n        skipLocationChange: true\n      });\n    } else {\n      console.log('AlreadyAuthGuard: user not logged, remaining in page');\n      return true;\n    }\n  }\n\n}\n\nAlreadyAuthIn.ɵfac = function AlreadyAuthIn_Factory(t) {\n  return new (t || AlreadyAuthIn)(i0.ɵɵinject(i1.ClientService), i0.ɵɵinject(i2.Router));\n};\n\nAlreadyAuthIn.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n  token: AlreadyAuthIn,\n  factory: AlreadyAuthIn.ɵfac,\n  providedIn: 'root'\n});","map":{"version":3,"mappings":";AACA,SAAQA,sBAAR,EAA6CC,MAA7C,EAAqDC,mBAArD,EAA0EC,OAA1E,QAAwF,iBAAxF;;;;AAOA,OAAM,MAAOC,aAAP,CAAoB;EACxBC,YAAoBC,aAApB,EACoBC,MADpB,EACkC;IADd;IACA;EAAoB;;EACxCC,WAAW,CACTC,KADS,EAETC,KAFS,EAEiB;IAAA;;IAE1B,IAAIC,YAAY,CAACC,OAAb,CAAqB,cAArB,KAAwC,IAA5C,EAAkD;MAChDC,OAAO,CAACC,GAAR,CAAY,4DAAZ;MACA,OAAO,IAAP;IACD;;IACD,IAAIC,MAAJ;;IACA,MAAMC,IAAI;MAAA,6BAAG,aAAW;QACtB,MAAM,KAAI,CAACV,aAAL,CAAmBW,YAAnB,GACHC,IADG,CACEC,CAAC,IAAIJ,MAAM,GAAGI,CADhB,CAAN;MAED,CAHS;;MAAA,gBAAJH,IAAI;QAAA;MAAA;IAAA,GAAV,CAP0B,CAW1B;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IAEA;IACA;IACA;IACA;;;IACAH,OAAO,CAACC,GAAR,CAAY,iCAAgCC,MAA5C;;IACA,IAAIA,MAAM,IAAI,IAAd,EAAoB;MAClBF,OAAO,CAACC,GAAR,CAAY,0EAAZ;MACA,OAAO,KAAKP,MAAL,CAAYa,QAAZ,CAAqB,CAAC,uBAAD,CAArB,EAAgD;QAACC,kBAAkB,EAAE;MAArB,CAAhD,CAAP;IACD,CAHD,MAGO;MACLR,OAAO,CAACC,GAAR,CAAY,sDAAZ;MACA,OAAO,IAAP;IACD;EACF;;AA3CuB;;;mBAAbV,eAAakB;AAAA;;;SAAblB;EAAamB,SAAbnB,aAAa;EAAAoB,YAFZ","names":["ActivatedRouteSnapshot","Router","RouterStateSnapshot","UrlTree","AlreadyAuthIn","constructor","clientService","router","canActivate","route","state","localStorage","getItem","console","log","logged","test","isUserLogged","then","r","navigate","skipLocationChange","i0","factory","providedIn"],"sourceRoot":"","sources":["C:\\Users\\jrenau01\\IdeaProjects\\PizzaDeliveryApp\\PizzaApp-front\\src\\app\\client\\routerguards\\already-auth.guard.ts"],"sourcesContent":["import {Injectable} from '@angular/core';\nimport {ActivatedRouteSnapshot, CanActivate, Router, RouterStateSnapshot, UrlTree} from '@angular/router';\nimport {Observable} from 'rxjs';\nimport {ClientService} from \"../client.service\";\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class AlreadyAuthIn implements CanActivate {\n  constructor(private clientService: ClientService,\n              private router: Router) {  }\n  canActivate(\n    route: ActivatedRouteSnapshot,\n    state: RouterStateSnapshot): Observable<boolean | UrlTree> | Promise<boolean | UrlTree> | boolean | UrlTree {\n\n    if (localStorage.getItem('mainUsername') == null) {\n      console.log('AlreadyAuthGuard: not logged in Angular, remaining in page')\n      return true;\n    }\n    let logged;\n    const test = async () => {\n      await this.clientService.isUserLogged()\n        .then(r => logged = r);\n    };\n    // return this.clientService.isUserLogged()\n    //   .subscribe(\n    //     (response: Response) => {\n    //       let loginStatus = response.message;\n    //       console.log(\"isUserLogged: LoginStatus from backend: \" + loginStatus)\n    //       if (loginStatus == 'not_logged') {\n    //         localStorage.clear();\n    //         console.log('AlreadyAuthGuard: user not logged, remaining in page');\n    //         return true;\n    //       } else {\n    //         console.log('AlreadyAuthGuard: user already logged, redirecting to client-action page');\n    //         return this.router.navigate(['/client/client-action'], {skipLocationChange: true});\n    //       }\n    //     });\n\n    // setTimeout(() => {\n    //     console.log('AlreadyAuthGuard: checkLoginStatus is '+typeof logged+', waiting 1,5 seconds')\n    // }, 2000);\n    //\n    console.log('AlreadyAuthGuard: logged is '+ logged)\n    if (logged == true) {\n      console.log('AlreadyAuthGuard: user already logged, redirecting to client-action page');\n      return this.router.navigate(['/client/client-action'], {skipLocationChange: true});\n    } else {\n      console.log('AlreadyAuthGuard: user not logged, remaining in page');\n      return true;\n    }\n  }\n}\ninterface Response {\n  message: string;\n  messageB: string;\n}\n"]},"metadata":{},"sourceType":"module"}